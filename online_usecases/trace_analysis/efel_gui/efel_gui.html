


<!DOCTYPE html>


<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Feature extraction &#8212; HBP Brain Simulation Platform Guidebook 0.1.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/hbpdoc.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/bsp.css" />
    <link rel="stylesheet" href="../../../_static/css/bsp.css" type="text/css" />
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/load_ga.js"></script>
    <script src="../../../_static/extra.js"></script>
    <script src="../../../_static/hbpdoc.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Synaptic events fitting" href="../syn_events_fit/syn_events_fit.html" />
    <link rel="prev" title="Trace Analysis" href="../trace_analysis.html" />
<meta name="viewport" content="width=device-width, initial-scale=1">

  </head><body>
<div class="hbpdoc-page">
    <section class="hbpdoc-title page-header">
        <a class="project-title" href="../../../index.html">HBP Brain Simulation Platform Guidebook</a>

        <a class="hbpdoc-toc-toggle pull-right" href>
            <span class="zmdi zmdi-menu"></span> <span class="sr-only icon-text">Menu</span>
        </a>
    </section>
    <section class="hbpdoc-main">
        <nav class="hbpdoc-sidebar hbpdoc-container">
            <a class="hbpdoc-toc-toggle pull-right" href>
                <span class="zmdi zmdi-menu"></span> <span class="sr-only icon-text">Menu</span>
            </a>
            
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Feature extraction</a><ul>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#electrophysiological-data">Electrophysiological data</a><ul>
<li><a class="reference internal" href="#hbp-database">HBP database</a></li>
<li><a class="reference internal" href="#user-s-uploaded-data">User’s uploaded data</a></li>
<li><a class="reference internal" href="#feature-description-label">Feature Extraction</a></li>
</ul>
</li>
<li><a class="reference internal" href="#graphical-user-interface">Graphical User Interface</a><ul>
<li><a class="reference internal" href="#trace-selection">Trace Selection</a></li>
<li><a class="reference internal" href="#feature-selection">Feature selection</a></li>
<li><a class="reference internal" href="#results">Results</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="../trace_analysis.html"
                        title="previous chapter">Trace Analysis</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../syn_events_fit/syn_events_fit.html"
                        title="next chapter">Synaptic events fitting</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../../_sources/online_usecases/trace_analysis/efel_gui/efel_gui.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
        </nav>

        <article class="hbpdoc-content">

            <div class="content">
                
                <div class="breadcrumb breadcrumb-meta expand">
                    
                    <a href="../../online_usecases.html">Online Use Cases</a>
                    
                    <a href="../trace_analysis.html">Trace Analysis</a>
                    
                </div>
                

                <aside class="hbpdoc-hnav hbpdoc-hnav-top">
                    
                    <span class="hbpdoc-hnav-previous">
                        previous: <a class="hbpdoc-hnav-link" href="../trace_analysis.html">Trace Analysis</a>
                    </span>
                    
                    
                    <span class="hbpdoc-hnav-next">
                        next: <a class="hbpdoc-hnav-link" href="../syn_events_fit/syn_events_fit.html">Synaptic events fitting</a>
                    </span>
                    
                </aside>

                <div class="section" id="feature-extraction">
<span id="efel-gui"></span><h1>Feature extraction<a class="headerlink" href="#feature-extraction" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<div class="bsp-container-left docutils container">
<a class="reference internal image-reference" href="../../../_images/spikesEfel.png"><img alt="../../../_images/spikesEfel.png" class="align-right" src="../../../_images/spikesEfel.png" style="width: 307.8px; height: 206.1px;" /></a>
</div>
<p>The Feature Extraction Graphical User Interface (GUI) is a web application that
allows users to extract an ensemble of electrophysiological properties from
voltage traces recorded upon electrical stimulation of neuronal cells (see
figure on the left). The main outcome of the application is the generation of two files
- <em>features.json</em> and <em>protocol.json</em> - that can be used for
later model parameter optimizations.</p>
<p>For data selection, there are three scenarios are possible: 1) Based on
her/his data permissions (see <a class="reference internal" href="#electrophys-data-label"><span class="std std-ref">Electrophysiological data</span></a>), the user selects
voltage traces from the Human Brain Project (HBP) database; 2) The user selects
the voltage traces from uploaded data files (through the “Upload”
utility of the GUI); 3) The user selects traces from both the HBP database and
her/his own uploaded file(s).</p>
<p>This application leverages the Python Electrophys Feature Extract Library (<a class="reference external" href="http://bluebrain.github.io/eFEL/index.html">eFEL</a>) and provides a friendly
interface to select voltage traces (individually or collectively, based on the
applied stimulus current) and features to be extracted.</p>
</div>
<div class="section" id="electrophysiological-data">
<span id="electrophys-data-label"></span><h2>Electrophysiological data<a class="headerlink" href="#electrophysiological-data" title="Permalink to this headline">¶</a></h2>
<p>The Feature Extraction can only be used for voltage traces recorded during a
step current stimulation protocol (see <a class="reference internal" href="#feature-description-label"><span class="std std-ref">Feature Extraction</span></a>). The
HBP data available through the application for public use are of this type, and
the user can only upload data files of the same
type (see <a class="reference internal" href="#hbp-data-label"><span class="std std-ref">HBP database</span></a>). Below is a brief description of the
data formats currently in use.</p>
<div class="section" id="hbp-database">
<span id="hbp-data-label"></span><h3>HBP database<a class="headerlink" href="#hbp-database" title="Permalink to this headline">¶</a></h3>
<p>Publicly available data consist of electrophysiological traces
provided by contributing laboratories internal and external to HBP (the
contributors are shown to the user after data selection, see
<a class="reference internal" href="#trace-selection-label"><span class="std std-ref">Trace Selection</span></a>). Each data file is associated with a list of
“authorized Collabs”, following the indications of the contributors. An
“authorized Collab” is a collab whose team members have read access to the data.
Regardless of the Collab from which they are executing the Feature Extraction
web app, users who are members of, at least, one Collab authorized for a set of
data, have read access to those data. Data for which the users have no
authorization will not be displayed.</p>
<p>Contributed raw data files are in the Axon Binary Format (<a class="reference external" href="http://mdc.custhelp.com/app/answers/detail/a_id/16506/~/pclamp%3A-versions-of-the-abf-file-format-are-associated-with-which-software">.abf</a>) or the Igor Binary
Format (<a class="reference external" href="https://www.wavemetrics.com/index.html">.ibw</a>) and each file is
accompanied by a <em>metadata.json</em> file in which the contributors describe cell
and protocol properties (e.g. <em>cell_id</em>, <em>brain_region</em>, <em>brain_structure</em>,
<em>stimulus_duration</em>, …) used for data processing and visualization. The data
are read through the <a class="reference external" href="https://pypi.python.org/pypi/neo/">Neo</a> and <a class="reference external" href="https://pypi.python.org/pypi/igor.py/0.9.1">Igorpy</a> Python packages and converted
into value arrays before use. The <em>metadata.json</em> files relative to the selected
traces will be downloadable in a future release of the web app.</p>
<p>If you would like to contribute with your own data to the Feature Extraction GUI
application, please send an email to <em>bsp-support AT humanbrainproject.eu</em> to
receive further detailed information on the data format and the <em>metadata.json</em>
template to fill in before data submission.</p>
</div>
<div class="section" id="user-s-uploaded-data">
<span id="user-data-label"></span><h3>User’s uploaded data<a class="headerlink" href="#user-s-uploaded-data" title="Permalink to this headline">¶</a></h3>
<p>Users can also upload and visualize their own data, which can be selected, for
processing, independently or together with traces from the HBP dataset.</p>
<p>At this moment only the (<a class="reference external" href="http://mdc.custhelp.com/app/answers/detail/a_id/16506/~/pclamp%3A-versions-of-the-abf-file-format-are-associated-with-which-software">.abf</a>) format (Version 2
and above), produced with <a class="reference external" href="http://mdc.custhelp.com/app/home">Molecular Devices</a> instruments is supported for upload.
To make sure that the recorded traces represent the outcome of a
step current stimulation experiment, the header of the file is checked for
compatibility as well. Uploading is denied when a file does not fulfill
requirements.</p>
<p>Below is an example of a permitted protocol header, extracted from a
representative <a class="reference external" href="http://mdc.custhelp.com/app/answers/detail/a_id/16506/~/pclamp%3A-versions-of-the-abf-file-format-are-associated-with-which-software">.abf</a>
file with the <a class="reference external" href="https://pypi.python.org/pypi/neo/">neo</a> package. In this
example, the stimulus consisted of three periods of duration 500, 10000 and 500
<em>ms</em> respectively, with an initial amplitude of zero. During the
central period, though, the stimulus amplitude is increased by 10.0 at every
recording sweep, as indicated in the <strong>lEpochLevelInc</strong> parameter (current unit
is <em>nA</em>).</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span> <span class="p">{</span><span class="nt">&quot;dictEpochInfoPerDAC&quot;</span><span class="p">:</span> <span class="p">{</span><span class="nt">&quot;0&quot;</span><span class="p">:</span> <span class="p">{</span><span class="nt">&quot;0&quot;</span><span class="p">:</span> <span class="p">{</span>  <span class="nt">&quot;fEpochInitLevel&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
                                        <span class="nt">&quot;fEpochLevelInc&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
                                        <span class="nt">&quot;lEpochDurationInc&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                                        <span class="nt">&quot;lEpochInitDuration&quot;</span><span class="p">:</span> <span class="mi">500</span><span class="p">,</span>
                                        <span class="nt">&quot;lEpochPulsePeriod&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                                        <span class="nt">&quot;lEpochPulseWidth&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                                        <span class="nt">&quot;nDACNum&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                                        <span class="nt">&quot;nEpochNum&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                                        <span class="nt">&quot;nEpochType&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                                     <span class="p">},</span>
                                <span class="nt">&quot;1&quot;</span><span class="p">:</span> <span class="p">{</span>  <span class="nt">&quot;fEpochInitLevel&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
                                        <span class="nt">&quot;fEpochLevelInc&quot;</span><span class="p">:</span> <span class="mf">10.0</span><span class="p">,</span>
                                        <span class="nt">&quot;lEpochDurationInc&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                                        <span class="nt">&quot;lEpochInitDuration&quot;</span><span class="p">:</span> <span class="mi">10000</span><span class="p">,</span>
                                        <span class="nt">&quot;lEpochPulsePeriod&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                                        <span class="nt">&quot;lEpochPulseWidth&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                                        <span class="nt">&quot;nDACNum&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                                        <span class="nt">&quot;nEpochNum&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                                        <span class="nt">&quot;nEpochType&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                                     <span class="p">},</span>
                                <span class="nt">&quot;2&quot;</span><span class="p">:</span> <span class="p">{</span>  <span class="nt">&quot;fEpochInitLevel&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
                                        <span class="nt">&quot;fEpochLevelInc&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
                                        <span class="nt">&quot;lEpochDurationInc&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                                        <span class="nt">&quot;lEpochInitDuration&quot;</span><span class="p">:</span> <span class="mi">500</span><span class="p">,</span>
                                        <span class="nt">&quot;lEpochPulsePeriod&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                                        <span class="nt">&quot;lEpochPulseWidth&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                                        <span class="nt">&quot;nDACNum&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                                        <span class="nt">&quot;nEpochNum&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
                                        <span class="nt">&quot;nEpochType&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>

                                      <span class="p">}</span>
                                <span class="p">}</span>
                            <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="feature-description-label">
<span id="id4"></span><h3>Feature Extraction<a class="headerlink" href="#feature-description-label" title="Permalink to this headline">¶</a></h3>
<p>The Feature Extraction process precedes the generation of the
<em>features.json</em> and <em>protocol.json</em> files, which are used for model parameter
optimization performed through the <a class="reference external" href="https://github.com/BlueBrain/BluePyOpt">BluePyOpt</a> software tool (please refer to the
BluePyOpt <a class="reference external" href="http://bluepyopt.readthedocs.io/en/latest/">documentation</a> for
detailed explanation).</p>
<p>The features that the user can select for extraction are described under this <a class="reference external" href="http://bluebrain.github.io/eFEL/index.html">link</a> as well as the eFEL software
package used to process the data. See also <a class="reference internal" href="../../single_cell_building/overview/overview.html#hippocampal-neurons"><span class="std std-ref">Hippocampal Neurons</span></a> in this guidebook.</p>
<p>Features are computed for every trace of the chosen recordings, where a trace
corresponds to a given stimulus current amplitude (indicated to the user when
data are displayed).
Once the extraction is finalized, the values of a feature obtained from traces
belonging to an individual cell and corresponding to the same stimulation
amplitude are averaged.
The averages computed for all the cells, are averaged a second time
by stimulus amplitude.
This will generate two result files (i.e. <em>features.json</em> and <em>protocols.json</em>)
per cell plus two supplementary files with the global averages.</p>
<p>While the <a class="reference external" href="http://bluebrain.github.io/eFEL/index.html">eFEL</a> extracts the
features of interest from single traces (individually selected or grouped), it
does not take into account any information on the cell properties, such as the
<em>cell_id</em> needed to group the results for the generation of the above mentioned
<em>features.json</em> and <em>protocol.json</em>. To perform this wrapping we used a custom
Python code (please contact <cite>bsp-support AT humanbrainproject.eu</cite> for further
information).</p>
</div>
</div>
<div class="section" id="graphical-user-interface">
<h2>Graphical User Interface<a class="headerlink" href="#graphical-user-interface" title="Permalink to this headline">¶</a></h2>
<p>The GUI guides the user through the feature extraction process in a friendly
way. The web application homepage shows a brief tutorial on the usage of the
interface. After the user has read (or skipped) the howto (s)he is requested to
accept the Terms &amp; Conditions for the use of the public data (see figure below).</p>
<div class="bsp-container-center docutils container">
<a class="reference internal image-reference" href="../../../_images/termsconds.png"><img alt="../../../_images/termsconds.png" class="align-right" src="../../../_images/termsconds.png" style="width: 500px;" /></a>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>The following is a description of the Feature Extraction process.</p>
<div class="section" id="trace-selection">
<span id="trace-selection-label"></span><h3>Trace Selection<a class="headerlink" href="#trace-selection" title="Permalink to this headline">¶</a></h3>
<p>Once the trace selection page is displayed, data can be filtered from the HBP
dataset by the user, by choosing the following properties of the cell from five
menu lists:
1) Species; 2) Brain structure; 3) Region; 4) Type; 5) Electrical type (<a class="reference external" href="https://bbp.epfl.ch/nmc-portal/glossary">eType</a>). If any of the fields is
missing (e.g. the eType of the cell is not known), the “unknown” label is
displayed.</p>
<p>When the data are loaded, the traces contained in each file are shown and data
files are grouped by cell id (see figure below). The user can select individual
traces by clicking on the corresponding amplitude or (s)he can select/deselect
all traces in a single file. Additionally, all files (and then all
traces) referring to a single cell can be selected.</p>
<div class="bsp-container-center docutils container">
<a class="reference internal image-reference" href="../../../_images/traceselect.png"><img alt="../../../_images/traceselect.png" class="align-right" src="../../../_images/traceselect.png" style="width: 500px;" /></a>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Alternatively, or concurrently, users can upload their own data (see
<a class="reference internal" href="#user-data-label"><span class="std std-ref">User’s uploaded data</span></a>) by browsing their local storage and using the upload
button (see figure below). The traces will be displayed for selection, together
with the ones selected from the HBP dataset (if any).</p>
<div class="bsp-container-center docutils container">
<a class="reference internal image-reference" href="../../../_images/upload.png"><img alt="../../../_images/upload.png" class="align-right" src="../../../_images/upload.png" style="width: 500px;" /></a>
</div>
</div>
<div class="section" id="feature-selection">
<h3>Feature selection<a class="headerlink" href="#feature-selection" title="Permalink to this headline">¶</a></h3>
<p>Once the trace selection approved, the feature selection page is displayed.
Features are grouped by type -spike event features, spike shape features,
voltage features- and can be selected individually or collectively through the
select/deselect buttons. Given the high number of features, the three types are
grouped in toggle boxes (see figure below). Upon selection approval, the feature
extraction process takes place as described in
<a class="reference internal" href="#feature-description-label"><span class="std std-ref">Feature Extraction</span></a>).</p>
<div class="bsp-container-center docutils container">
<a class="reference internal image-reference" href="../../../_images/featureselect.png"><img alt="../../../_images/featureselect.png" class="align-right" src="../../../_images/featureselect.png" style="width: 500px;" /></a>
</div>
</div>
<div class="section" id="results">
<h3>Results<a class="headerlink" href="#results" title="Permalink to this headline">¶</a></h3>
<p>Finally, a success message is displayed and results are made available to
download. The application output consists of a <strong>features.json</strong> and <strong>protocols.json</strong> files which are generated for both individual cells and the entire ensemble. These files contain the feature value averages (computed as outlined in the above section “Feature Extraction”) and the protocols adopted for the experimental recordings. These files are intended to be used for the data-driven optimization step of the Hodgkin-Huxley Neuron Builder workflow, made available to the user through the Brain Simulation Platform at the <a class="reference external" href="https://collab.humanbrainproject.eu/#/collab/1655/nav/66898">Highly Integrated Workflows</a> page.</p>
<div class="bsp-container-center docutils container">
<a class="reference internal image-reference" href="../../../_images/download.png"><img alt="../../../_images/download.png" class="align-right" src="../../../_images/download.png" style="width: 500px;" /></a>
</div>
</div>
</div>
</div>

            </div>

            <aside class="hbpdoc-hnav hbpdoc-hnav-bottom">
                
                <span class="hbpdoc-hnav-previous">
                    previous: <a class="hbpdoc-hnav-link" href="../trace_analysis.html">Trace Analysis</a>
                </span>
                
                
                <span class="hbpdoc-hnav-next">
                    next: <a class="hbpdoc-hnav-link" href="../syn_events_fit/syn_events_fit.html">Synaptic events fitting</a>
                </span>
                
            </aside>
        </article>
    </section>


    <div class="hbpdoc-footer">
        HBP Brain Simulation Platform Guidebook <small>0.1</small> 
    <div class="footer" role="contentinfo">
        &#169; Copyright 2019, Brain Simulation Platform members.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.0.2.
    </div>
    </div>
</div>

  </body>
</html>