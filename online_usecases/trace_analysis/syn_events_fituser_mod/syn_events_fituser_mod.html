


<!DOCTYPE html>


<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Synaptic events fitting with user model &#8212; HBP Brain Simulation Platform Guidebook 0.1.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/hbpdoc.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/bsp.css" />
    <link rel="stylesheet" href="../../../_static/css/bsp.css" type="text/css" />
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/load_ga.js"></script>
    <script src="../../../_static/extra.js"></script>
    <script src="../../../_static/hbpdoc.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Synaptic events fitting with user data" href="../syn_events_fit_user_data/syn_events_fit_user_data.html" />
    <link rel="prev" title="Synaptic events fitting" href="../syn_events_fit/syn_events_fit.html" />
<meta name="viewport" content="width=device-width, initial-scale=1">

  </head><body>
<div class="hbpdoc-page">
    <section class="hbpdoc-title page-header">
        <a class="project-title" href="../../../index.html">HBP Brain Simulation Platform Guidebook</a>

        <a class="hbpdoc-toc-toggle pull-right" href>
            <span class="zmdi zmdi-menu"></span> <span class="sr-only icon-text">Menu</span>
        </a>
    </section>
    <section class="hbpdoc-main">
        <nav class="hbpdoc-sidebar hbpdoc-container">
            <a class="hbpdoc-toc-toggle pull-right" href>
                <span class="zmdi zmdi-menu"></span> <span class="sr-only icon-text">Menu</span>
            </a>
            
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Synaptic events fitting with user model</a><ul>
<li><a class="reference internal" href="#synaptic-events-fitting-with-a-user-model-config">Synaptic events fitting with a user model - Config</a></li>
<li><a class="reference internal" href="#synaptic-events-fitting-with-user-model-analysis">Synaptic events fitting with user model - Analysis</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="../syn_events_fit/syn_events_fit.html"
                        title="previous chapter">Synaptic events fitting</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../syn_events_fit_user_data/syn_events_fit_user_data.html"
                        title="next chapter">Synaptic events fitting with user data</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../../_sources/online_usecases/trace_analysis/syn_events_fituser_mod/syn_events_fituser_mod.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
        </nav>

        <article class="hbpdoc-content">

            <div class="content">
                
                <div class="breadcrumb breadcrumb-meta expand">
                    
                    <a href="../../online_usecases.html">Online Use Cases</a>
                    
                    <a href="../trace_analysis.html">Trace Analysis</a>
                    
                </div>
                

                <aside class="hbpdoc-hnav hbpdoc-hnav-top">
                    
                    <span class="hbpdoc-hnav-previous">
                        previous: <a class="hbpdoc-hnav-link" href="../syn_events_fit/syn_events_fit.html">Synaptic events fitting</a>
                    </span>
                    
                    
                    <span class="hbpdoc-hnav-next">
                        next: <a class="hbpdoc-hnav-link" href="../syn_events_fit_user_data/syn_events_fit_user_data.html">Synaptic events fitting with user data</a>
                    </span>
                    
                </aside>

                <div class="section" id="synaptic-events-fitting-with-user-model">
<span id="syn-events-fit-user-mod"></span><h1>Synaptic events fitting with user model<a class="headerlink" href="#synaptic-events-fitting-with-user-model" title="Permalink to this headline">¶</a></h1>
<p>This Use Case allows a user to fit synaptic events using user’s data and model.</p>
<p>Selecting this use case, two Jupyter Notebooks are cloned in a private existing/new Collab.
The cloned Notebooks are:</p>
<div class="section" id="synaptic-events-fitting-with-a-user-model-config">
<h2>Synaptic events fitting with a user model - Config<a class="headerlink" href="#synaptic-events-fitting-with-a-user-model-config" title="Permalink to this headline">¶</a></h2>
<p>It allows the user to:</p>
<ol class="arabic simple">
<li><p>Select a local experimental file</p></li>
</ol>
<div class="bsp-container-center docutils container">
<a class="reference internal image-reference" href="../../../_images/select_exp1.png"><img alt="../../../_images/select_exp1.png" class="align-center" src="../../../_images/select_exp1.png" style="width: 450px;" /></a>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>At this time, the only accepted format for the experimental file is a text file with time in the first column and individual traces in successive columns. All columns must be of the same length</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Select a local mod file</p></li>
</ol>
<div class="bsp-container-center docutils container">
<a class="reference internal image-reference" href="../../../_images/select_mod.png"><img alt="../../../_images/select_mod.png" class="align-center" src="../../../_images/select_mod.png" style="width: 450px;" /></a>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>We assume that the user knows what we are talking about here, and that the
uploaded mod file has been already tested by the user in preliminary
simulations. The program does not perform checks on this. An invalid file will
result in errors at NEURON compilation time</p>
<p>All other parameters that are not fitted have their default value as
defined in the mod file.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Fill in the form with the values needed to write a configuration file: the
number of traces in the experimental file, the protocol (voltage clamp
amplitude and reversal potential of the synapse), the name of the parameters
to be fitted, their initial values and the allowed variation range,
exclusion rules, and an optional set of dependencies for other parameters.
Typical values are shown in the figure below</p></li>
</ol>
<div class="bsp-container-center docutils container">
<a class="reference internal image-reference" href="../../../_images/fill_form1.png"><img alt="../../../_images/fill_form1.png" class="align-center" src="../../../_images/fill_form1.png" style="width: 450px;" /></a>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="bsp-container-center docutils container">
<a class="reference internal image-reference" href="../../../_images/initial_values.png"><img alt="../../../_images/initial_values.png" class="align-center" src="../../../_images/initial_values.png" style="width: 450px;" /></a>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="bsp-container-center docutils container">
<a class="reference internal image-reference" href="../../../_images/dependencies1.png"><img alt="../../../_images/dependencies1.png" class="align-center" src="../../../_images/dependencies1.png" style="width: 450px;" /></a>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ol class="arabic simple" start="4">
<li><p>Configure the parameters of the optimization job: the title of the job, the number of nodes, the number of cores and the runtime. Run the fitting procedure using UNICORE authentication on JURECA (booster partition), GALILEO, or on NSG (using your account), and check the job status.</p></li>
</ol>
<p>On JURECA the number of nodes, number of CPUs per node and runtime are set by default to 2, 24 and 10m respectively</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>On GALILEO the number of nodes, number of CPUs per node and runtime are set by default to 2, 36 and 10m respectively</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>The user needs to be aware of the limitations imposed by each HPC system on resources</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>On NSG the number of nodes, number of cores and runtime are set by default to 2, 24 and 0.5 (hours) respectively. The maximum number of nodes available per job is 72. If you require more than 72 nodes please contact <a class="reference external" href="mailto:nsghelp&#37;&#52;&#48;sdsc&#46;edu">nsghelp<span>&#64;</span>sdsc<span>&#46;</span>edu</a>. The maximum number of cores required per node is 24.</p>
<div class="bsp-container-center docutils container">
<a class="reference internal image-reference" href="../../../_images/submission_process_021.png"><img alt="../../../_images/submission_process_021.png" class="align-center" src="../../../_images/submission_process_021.png" style="width: 650px;" /></a>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Note that when the job is submitted through UNICORE, the user can specify the project to use to submit the job on the HPC.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="bsp-container-center docutils container">
<a class="reference internal image-reference" href="../../../_images/unicore2.png"><img alt="../../../_images/unicore2.png" class="align-center" src="../../../_images/unicore2.png" style="width: 300px;" /></a>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Note that when the job is submitted through NSG, the user can see the
submission date converted to CET time next to the status of the job. This will
be useful in the analysis notebook in order to fetch the job.</p>
<p>The user can choose to fit all experimental traces 100 times, a single trace 20
times or use a demo version where a trace is fitted 5 times. For the single
trace and the demo version the user can choose the trace to be fitted.</p>
<p>Once the job is completed, the output files will be in the Collab storage under
different directories, according to the system used.</p>
<p>JURECA: results are saved under the resultsJureca/jobtitle_fitting_submissionTime folder.</p>
<p>GALILEO: results are saved under the resultsGalileo/jobtitle_fitting_submissionTime folder.</p>
<p>NSG results are saved under the resultsNSG/jobtitle_fitting_submissionTime folder.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ol class="arabic simple" start="5">
<li><p>If you are interested in the code, click on the “Click here to toggle on/off the source code” button</p></li>
</ol>
<div class="bsp-container-center docutils container">
<a class="reference internal image-reference" href="../../../_images/toggle_button4.png"><img alt="../../../_images/toggle_button4.png" class="align-center" src="../../../_images/toggle_button4.png" style="width: 300px;" /></a>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ol class="arabic simple" start="6">
<li><p>If you want to start a new fitting from the beginning, click on the “Click here to start a new fit” button.</p></li>
</ol>
<div class="bsp-container-center docutils container">
<a class="reference internal image-reference" href="../../../_images/Restart2.png"><img alt="../../../_images/Restart2.png" class="align-center" src="../../../_images/Restart2.png" style="width: 300px;" /></a>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="synaptic-events-fitting-with-user-model-analysis">
<h2>Synaptic events fitting with user model - Analysis<a class="headerlink" href="#synaptic-events-fitting-with-user-model-analysis" title="Permalink to this headline">¶</a></h2>
<p>This Jupyter Notebook allows the user to fetch the fitting results from the
storage of the HPC system to the storage of the Collab or to analyze the
optimized parameters. If the user wants to view an analysis of simulations that
are already in the storage of the Collab, (s)he can skip the
‘View simulations’ tab and go directly to the ‘View analysis’ tab.</p>
<div class="bsp-container-center docutils container">
<a class="reference internal image-reference" href="../../../_images/viewsim1.png"><img alt="../../../_images/viewsim1.png" class="align-center" src="../../../_images/viewsim1.png" style="width: 700px;" /></a>
</div>
<p>In the ‘View simulations’ tab, the user can visualize the Name/ID, status,
the submission date of the simulations submitted on the HPC systems and (s)he
can obtain an output of successfully completed jobs.</p>
<div class="bsp-container-center docutils container">
<a class="reference internal image-reference" href="../../../_images/viewsimulations.png"><img alt="../../../_images/viewsimulations.png" class="align-center" src="../../../_images/viewsimulations.png" style="width: 700px;" /></a>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="bsp-container-center docutils container">
<a class="reference internal image-reference" href="../../../_images/viewsimulations2.png"><img alt="../../../_images/viewsimulations2.png" class="align-center" src="../../../_images/viewsimulations2.png" style="width: 700px;" /></a>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="bsp-container-center docutils container">
<a class="reference internal image-reference" href="../../../_images/viewsimulations3.png"><img alt="../../../_images/viewsimulations3.png" class="align-center" src="../../../_images/viewsimulations3.png" style="width: 700px;" /></a>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>In the ‘View analysis’ tab, the user can analyze the optimized parameters for
default data and a mod file combination or browse through the optimized
parameters available in the Collab storage.</p>
<div class="bsp-container-center docutils container">
<a class="reference internal image-reference" href="../../../_images/viewanalysis1.png"><img alt="../../../_images/viewanalysis1.png" class="align-center" src="../../../_images/viewanalysis1.png" style="width: 700px;" /></a>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>The user can visualize the data in table form, a box plot and the best fit.</p>
<ol class="arabic simple">
<li><p>The table of results (sorted in ascending order by the fitting error).</p></li>
</ol>
<div class="bsp-container-center docutils container">
<a class="reference internal image-reference" href="../../../_images/results_table.png"><img alt="../../../_images/results_table.png" class="align-center" src="../../../_images/results_table.png" style="width: 700px;" /></a>
</div>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
<ol class="arabic simple" start="2">
<li><p>The boxplot of the normalized results.</p></li>
</ol>
<div class="bsp-container-center docutils container">
<a class="reference internal image-reference" href="../../../_images/results_box.png"><img alt="../../../_images/results_box.png" class="align-center" src="../../../_images/results_box.png" style="width: 700px;" /></a>
</div>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
<ol class="arabic simple" start="3">
<li><p>The best fit.</p></li>
</ol>
<div class="bsp-container-center docutils container">
<a class="reference internal image-reference" href="../../../_images/results_fit.png"><img alt="../../../_images/results_fit.png" class="align-center" src="../../../_images/results_fit.png" style="width: 700px;" /></a>
</div>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
<p>If you are interested in the code, click on the “Click here to toggle on/off
the source code” button.</p>
<div class="bsp-container-center docutils container">
<a class="reference internal image-reference" href="../../../_images/toggle_button2.png"><img alt="../../../_images/toggle_button2.png" class="align-center" src="../../../_images/toggle_button2.png" style="width: 300px;" /></a>
</div>
</div>
</div>

            </div>

            <aside class="hbpdoc-hnav hbpdoc-hnav-bottom">
                
                <span class="hbpdoc-hnav-previous">
                    previous: <a class="hbpdoc-hnav-link" href="../syn_events_fit/syn_events_fit.html">Synaptic events fitting</a>
                </span>
                
                
                <span class="hbpdoc-hnav-next">
                    next: <a class="hbpdoc-hnav-link" href="../syn_events_fit_user_data/syn_events_fit_user_data.html">Synaptic events fitting with user data</a>
                </span>
                
            </aside>
        </article>
    </section>


    <div class="hbpdoc-footer">
        HBP Brain Simulation Platform Guidebook <small>0.1</small> 
    <div class="footer" role="contentinfo">
        &#169; Copyright 2019, Brain Simulation Platform members.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.0.2.
    </div>
    </div>
</div>

  </body>
</html>